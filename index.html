<!DOCTYPE html>
<html class="light" lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Segovia: CumpleFunny - Domingo 1 Feb</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#17a14e",
                        "background-light": "#f6f8f7",
                        "background-dark": "#112117",
                        "stone-light": "#e8e8e3",
                        "stone-dark": "#2d2d2a",
                        "steel": "#4b5563",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"],
                        "serif": ["Playfair Display", "serif"],
                        "body": ["Inter", "sans-serif"],
                    },
                    borderRadius: {"DEFAULT": "0.5rem", "lg": "1rem", "xl": "1.5rem", "full": "9999px"},
                },
            },
        }
    </script>
    
    <style>
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Playfair Display', serif;
        }
        
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 450px;
        }
        
        @media (max-width: 640px) {
            .chart-container {
                height: 320px;
            }
        }
        
        .active-timeline-btn {
            background: #17a14e;
            color: white;
            border-color: #17a14e;
            box-shadow: 0 6px 20px rgba(23, 161, 78, 0.2);
        }
        
        .inactive-timeline-btn {
            background: white;
            color: #6b7280;
            border: 2px solid #e5e7eb;
        }
        
        .inactive-timeline-btn:hover {
            border-color: rgba(23, 161, 78, 0.5);
            color: #17a14e;
        }
        
        .restaurant-card-selected {
            border-left-color: #17a14e !important;
            border-left-width: 4px;
            opacity: 1;
        }
        
        .restaurant-card-unselected {
            border-left-color: transparent;
            border-left-width: 4px;
            opacity: 0.7;
        }
        
        .restaurant-card-unselected:hover {
            border-left-color: #d1d5db;
            opacity: 1;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-stone-dark dark:text-stone-light min-h-screen flex flex-col">

    <!-- Navbar -->
    <header class="sticky top-0 z-50 bg-white/80 dark:bg-[#112117]/80 backdrop-blur-md border-b border-stone-200 dark:border-stone-800">
        <div class="layout-container flex h-full flex-col max-w-[960px] mx-auto">
            <div class="flex items-center justify-between px-6 py-4">
                <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-primary text-2xl">castle</span>
                    <h2 class="text-xl font-bold tracking-tight text-stone-900 dark:text-white font-serif">Funny 2026</h2>
                </div>
                <nav class="hidden md:flex gap-8">
                    <a class="text-sm font-medium text-stone-600 hover:text-primary dark:text-stone-300 transition-colors" href="#itinerary">Itinerario</a>
                    <a class="text-sm font-medium text-stone-600 hover:text-primary dark:text-stone-300 transition-colors" href="#dining">Gastronom√≠a</a>
                    <a class="text-sm font-medium text-stone-600 hover:text-primary dark:text-stone-300 transition-colors" href="#logistics">Log√≠stica</a>
                </nav>
                <div class="flex items-center gap-3">
                    <a href="galeria.html" class="flex items-center gap-2 px-4 py-2 rounded-full bg-primary hover:bg-primary/90 text-white text-xs font-bold uppercase tracking-wider transition-colors shadow-sm">
                        <span class="material-symbols-outlined text-base">photo_library</span>
                        <span class="hidden sm:inline">Galer√≠a</span>
                    </a>
                    <div class="px-4 py-1.5 rounded-full bg-primary/10 text-primary text-xs font-bold uppercase tracking-wider border border-primary/20">
                        1 FEB
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow">
        <!-- Hero Section -->
        <section class="relative w-full h-[600px] flex items-center justify-center overflow-hidden">
            <div class="absolute inset-0 z-0">
                <div class="absolute inset-0 bg-stone-900/30 backdrop-blur-[2px] z-10"></div>
                <img alt="Vista panor√°mica del Acueducto de Segovia bajo un cielo nublado" class="w-full h-full object-cover grayscale-[30%]" src="https://lh3.googleusercontent.com/aida-public/AB6AXuCEgWlc4h2D9TuWKKob5HSFhtMq8CCyz0toNIqJrLeEiIrTBu7VLsTd3eLXKaU2ktuT2h2jRS5IUbUZ26dbbQlDuFQDNw_HVX0MW1FZs7PCwYtuUVxvJvnTinoTG3ZR4m7AYwh2BIZhmfYMQn-n6mXJ_vYklF5-hpY1fVqFkHdNsQj0BQlgOhG_7LXkTaFeqlwqvqg0JIWgCN2Y_VSyMZjwA7s2jT5zJINQiLub4Zo86PYpGF1f0rnVxNbw94gxUkH0vcC3mvpRh2E"/>
            </div>
            <div class="relative z-20 max-w-[960px] w-full px-6 flex flex-col md:flex-row items-end justify-between gap-8 pb-12 h-full">
                <div class="flex flex-col gap-4 max-w-2xl mb-12">
                    <div class="inline-flex items-center gap-2 px-3 py-1 bg-white/20 backdrop-blur-md rounded-full border border-white/10 w-fit">
                        <span class="material-symbols-outlined text-white text-sm">rainy</span>
                        <span class="text-white text-xs font-medium tracking-wide">Lluvia Ligera, 3-9¬∞C</span>
                    </div>
                    <h1 class="text-5xl md:text-7xl font-bold text-white leading-tight">
                        Cumplea√±os <br/> <span class="text-primary italic font-serif">&amp; Funny 35</span>
                    </h1>
                    <p class="text-stone-100 text-lg md:text-xl font-light max-w-lg mt-2 font-display opacity-90 leading-relaxed border-l-2 border-primary pl-4">
                        Web creada para la logistica y el recuerdo de la trigesimo quinta vuelta a nuestro astro de Funny!!! 
                </div>
            </div>
        </section>

        <div class="layout-container max-w-[960px] mx-auto px-6 py-16 flex flex-col gap-24">
            <!-- Interactive Timeline Section -->
            <section class="scroll-mt-24" id="itinerary">
                <div class="mb-10 flex items-end justify-between border-b border-stone-200 pb-4 dark:border-stone-800">
                    <h3 class="text-3xl font-bold text-stone-900 dark:text-white">Cronolog√≠a del D√≠a</h3>
                    <span class="text-sm text-stone-500 font-display">Navega por las horas para ver detalles</span>
                </div>
                
                <!-- Visual Timeline -->
                <div class="flex flex-wrap md:flex-nowrap gap-4 justify-between items-center py-4 px-2 border-b border-dashed border-stone-200 dark:border-stone-800 overflow-x-auto no-scrollbar mb-6">
                    <div class="flex items-center gap-2 text-stone-400 min-w-max">
                        <span class="material-symbols-outlined text-sm">directions_car</span>
                        <span class="text-xs font-medium">9:30</span>
                    </div>
                    <div class="h-[1px] w-full min-w-[20px] bg-stone-200 dark:bg-stone-800 hidden md:block"></div>
                    <div class="flex items-center gap-2 text-stone-400 min-w-max">
                        <span class="material-symbols-outlined text-sm">local_parking</span>
                        <span class="text-xs font-medium">10:30</span>
                    </div>
                    <div class="h-[1px] w-full min-w-[20px] bg-stone-200 dark:bg-stone-800 hidden md:block"></div>
                    <div class="flex items-center gap-2 text-stone-400 min-w-max">
                        <span class="material-symbols-outlined text-sm">photo_camera</span>
                        <span class="text-xs font-medium">11:00</span>
                    </div>
                    <div class="h-[1px] w-full min-w-[20px] bg-stone-200 dark:bg-stone-800 hidden md:block"></div>
                    <div class="flex items-center gap-2 text-stone-400 min-w-max">
                        <span class="material-symbols-outlined text-sm">fort</span>
                        <span class="text-xs font-medium">11:30</span>
                    </div>
                    <div class="h-[1px] w-full min-w-[20px] bg-stone-200 dark:bg-stone-800 hidden md:block"></div>
                    <div class="flex items-center gap-2 text-stone-400 min-w-max">
                        <span class="material-symbols-outlined text-sm">restaurant</span>
                        <span class="text-xs font-medium">14:00</span>
                    </div>
                    <div class="h-[1px] w-full min-w-[20px] bg-stone-200 dark:bg-stone-800 hidden md:block"></div>
                    <div class="flex items-center gap-2 text-stone-400 min-w-max">
                        <span class="material-symbols-outlined text-sm">church</span>
                        <span class="text-xs font-medium">16:00</span>
                    </div>
                    <div class="h-[1px] w-full min-w-[20px] bg-stone-200 dark:bg-stone-800 hidden md:block"></div>
                    <div class="flex items-center gap-2 text-stone-400 min-w-max">
                        <span class="material-symbols-outlined text-sm">directions_car</span>
                        <span class="text-xs font-medium">17:30</span>
                    </div>
                </div>

                <!-- Timeline Navigation -->
                <div class="flex gap-3 overflow-x-auto pb-4 no-scrollbar" id="timeline-nav">
                    <!-- Buttons injected by JS -->
                </div>

                <!-- Dynamic Content Area -->
                <div id="timeline-content" class="relative mt-2">
                    <!-- Content injected by JS -->
                </div>
            </section>

            <!-- Gastronomy Analytics Section -->
            <section class="scroll-mt-24" id="dining">
                <div class="mb-8 border-b border-stone-200 pb-4 dark:border-stone-800">
                    <h3 class="text-3xl font-bold text-stone-900 dark:text-white">An√°lisis de Restaurantes</h3>
                    <p class="text-stone-700 dark:text-stone-300 text-base md:text-lg mt-2 leading-relaxed font-medium">
                        Elegir restaurante para 10 personas con dietas mixtas es complejo. Usa esta herramienta para comparar las mejores opciones disponibles.
                    </p>
                </div>
                
                <div class="flex flex-col lg:flex-row gap-8">
                    <!-- Restaurant List -->
                    <div class="flex-1 flex flex-col gap-4" id="restaurant-list">
                        <!-- Restaurant cards injected by JS -->
                    </div>
                    
                    <!-- Chart Container -->
                    <div class="flex-1 bg-white dark:bg-stone-900 rounded-xl border border-stone-200 dark:border-stone-800 p-8 flex flex-col items-center justify-center relative overflow-hidden">
                        <div class="absolute top-4 right-4 text-xs text-stone-400 uppercase tracking-widest font-bold">Matriz Comparativa</div>
                        <div class="chart-container w-full">
                            <canvas id="restaurantChart"></canvas>
                        </div>
                        <div id="rest-detail" class="mt-6 text-center">
                            <!-- Details injected by JS -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Logistics Footer -->
            <section class="grid md:grid-cols-2 gap-12 pt-8 border-t border-stone-200 dark:border-stone-800" id="logistics">
                <div>
                    <h3 class="text-xl font-bold font-serif mb-6 text-stone-900 dark:text-white">Checklist Pre-Viaje</h3>
                    
                    <!-- Add Task Form -->
                    <div class="mb-4 flex gap-2">
                        <input 
                            type="text" 
                            id="new-task-input" 
                            placeholder="A√±adir nueva tarea..." 
                            class="flex-grow px-4 py-2 rounded-lg border-2 border-stone-200 dark:border-stone-700 bg-white dark:bg-stone-900 text-stone-900 dark:text-white focus:border-primary focus:outline-none transition-colors"
                        />
                        <button 
                            id="add-task-btn"
                            class="px-4 py-2 bg-primary hover:bg-primary/90 text-white rounded-lg font-semibold transition-colors flex items-center gap-2 shadow-sm"
                        >
                            <span class="material-symbols-outlined text-lg">add</span>
                            <span class="hidden sm:inline">A√±adir</span>
                        </button>
                    </div>
                    
                    <div class="flex flex-col gap-4" id="checklist-container">
                        <!-- Checklist items injected by JS -->
                    </div>
                </div>
                
                <div class="bg-stone-900 text-stone-100 rounded-xl p-8 flex flex-col justify-between">
                    <div>
                        <h3 class="text-xl font-bold font-serif mb-6 text-white">Resumen del Viaje</h3>
                        <div class="grid grid-cols-2 gap-y-8 gap-x-4">
                            <div class="flex flex-col gap-1">
                                <span class="material-symbols-outlined text-stone-500 mb-1">group</span>
                                <span class="text-2xl font-bold text-white">10</span>
                                <span class="text-xs text-stone-400 font-medium uppercase tracking-wide">Personas</span>
                            </div>
                            <div class="flex flex-col gap-1">
                                <span class="material-symbols-outlined text-stone-500 mb-1">schedule</span>
                                <span class="text-2xl font-bold text-white">8h</span>
                                <span class="text-xs text-stone-400 font-medium uppercase tracking-wide">Duraci√≥n Total</span>
                            </div>
                            <div class="flex flex-col gap-1">
                                <span class="material-symbols-outlined text-stone-500 mb-1">directions_walk</span>
                                <span class="text-2xl font-bold text-white">5.2 km</span>
                                <span class="text-xs text-stone-400 font-medium uppercase tracking-wide">Distancia Caminando</span>
                            </div>
                            <div class="flex flex-col gap-1">
                                <span class="material-symbols-outlined text-stone-500 mb-1">rainy</span>
                                <span class="text-2xl font-bold text-white">3-9¬∞C</span>
                                <span class="text-xs text-stone-400 font-medium uppercase tracking-wide">Temperatura</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-8 pt-6 border-t border-stone-800">
                        <h4 class="font-bold text-white mb-4">Recordatorios Importantes</h4>
                        <ul class="text-sm space-y-3">
                            <li class="flex items-start">
                                <span class="material-symbols-outlined mr-2 text-primary text-lg">checkroom</span>
                                <div>
                                    <strong class="block text-white">Ropa:</strong>
                                    Calzado resistente al agua y c√≥modo. Abrigo por capas.
                                </div>
                            </li>
                            <li class="flex items-start">
                                <span class="material-symbols-outlined mr-2 text-primary text-lg">photo_camera</span>
                                <div>
                                    <strong class="block text-white">Foto Grupal:</strong>
                                    11:00 en Plaza del Azoguejo, antes del Alc√°zar.
                                </div>
                            </li>
                            <li class="flex items-start">
                                <span class="material-symbols-outlined mr-2 text-primary text-lg">cake</span>
                                <div>
                                    <strong class="block text-white">Ponche Segoviano:</strong>
                                    Parada obligatoria en "Lim√≥n y Menta" antes de salir.
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>
        </div>
    </main>
    
    <footer class="bg-white dark:bg-stone-950 border-t border-stone-200 dark:border-stone-800 py-8 mt-12">
        <div class="max-w-[960px] mx-auto px-6 flex flex-col md:flex-row justify-between items-center text-stone-500 text-sm">
            <p>Plan generado por Adri üëΩ e implementado por RikarPatolucas ü¶Üüëë</p>
            <div class="flex gap-6 mt-4 md:mt-0 items-center">
                <span class="flex items-center gap-2">
                    <span class="material-symbols-outlined text-xs">castle</span>
                    <span>Ciudad</span>
                </span>
                <span class="w-1 h-1 bg-stone-400 rounded-full"></span>
                <span class="flex items-center gap-2">
                    <span class="material-symbols-outlined text-xs">landscape</span>
                    <span>Campo</span>
                </span>
                <span class="w-1 h-1 bg-stone-400 rounded-full"></span>
                <span class="flex items-center gap-2">
                    <span class="text-primary">‚ù§Ô∏è</span>
                    <span>Segovia</span>
                </span>
            </div>
        </div>
    </footer>

    <script>
        // --- Data ---
        const timelineData = [
            {
                time: "9:30",
                title: "Salida desde la Sierra",
                icon: "directions_car",
                desc: "Inicio del viaje hacia Segovia.",
                details: "Punto de encuentro y salida desde la Sierra. Aseguraos de llevar todo lo necesario: paraguas, calzado c√≥modo y buen √°nimo. <br><br><em>Tiempo estimado de viaje: aproximadamente 1 hora hasta Segovia.</em>",
                mapsUrl: "https://www.google.com/maps/search/?api=1&query=Guadarrama+Madrid"
            },
            {
                time: "10:30",
                title: "Llegada y Parking",
                icon: "local_parking",
                desc: "Objetivo: Aparcar a cubierto. Evitar vueltas innecesarias.",
                details: "Dirig√≠os al <strong>Parking Acueducto (Oriental)</strong> o al de la Estaci√≥n de Autobuses. Est√°n a pie del Acueducto y son cubiertos. <br><br><em>Tip: No intent√©is aparcar en la calle, con lluvia y siendo 10 es perder el tiempo.</em>",
                mapsUrl: "https://www.google.com/maps/search/?api=1&query=Parking+Acueducto+Oriental+Segovia"
            },
            {
                time: "11:00",
                title: "Foto y Subida",
                icon: "photo_camera",
                desc: "La foto obligatoria y caminata.",
                details: "Foto r√°pida en la Plaza del Azoguejo con el Acueducto de fondo (y los paraguas). Subid inmediatamente por la Calle Real hacia el Alc√°zar (20 min andando). Es un paseo bonito pero mejor hacerlo r√°pido para llegar al refugio del Alc√°zar.",
                mapsUrl: "https://www.google.com/maps/search/?api=1&query=Plaza+del+Azoguejo+Acueducto+Segovia"
            },
            {
                time: "11:30",
                title: "El Alc√°zar",
                icon: "fort",
                desc: "Refugio monumental (Interior).",
                details: "<strong>IMPORTANTE:</strong> Entradas compradas ONLINE previamente. <br>Visita: Sala de los Reyes, Trono y Museo de Artiller√≠a. <br><em>Advertencia:</em> Si llueve mucho, no sub√°is a la Torre de Juan II (152 escalones y vistas mojadas/nulas).",
                mapsUrl: "https://www.google.com/maps/search/?api=1&query=Alcazar+de+Segovia"
            },
            {
                time: "14:00",
                title: "Comida",
                icon: "restaurant",
                desc: "Reserva confirmada (Vital).",
                details: "Hora cr√≠tica. Dirig√≠os al restaurante reservado. <br>Objetivo: Disfrutar del cochinillo y asegurar que los vegetarianos tengan sus platos especiales listos. Sobremesa tranquila hasta que escampe un poco.",
                mapsUrl: "https://www.google.com/maps/search/?api=1&query=La+Almuzara+Calle+Marques+del+Arco+3+Segovia"
            },
            {
                time: "16:00",
                title: "Catedral",
                icon: "church",
                desc: "La Dama de las Catedrales.",
                details: "Visita perfecta para la tarde (por la ma√±ana hay culto). Es inmensa y luminosa, ideal para bajar la comida caminando a cubierto. Abre a turismo sobre las 13:00, as√≠ que a las 16:00 est√° perfecta.",
                mapsUrl: "https://www.google.com/maps/search/?api=1&query=Catedral+de+Segovia"
            },
            {
                time: "17:30",
                title: "Postre y Regreso",
                icon: "directions_car",
                desc: "Ponche y Coche.",
                details: "Parad en <strong>Pasteler√≠a Lim√≥n y Menta</strong> a por Ponche Segoviano. Si quer√©is caf√©: La Colonial en Calle Real. <br><strong>18:30:</strong> Salida hacia casa para evitar el tr√°fico de las 20:00.",
                mapsUrl: "https://www.google.com/maps/search/?api=1&query=Pasteleria+Limon+y+Menta+Segovia"
            }
        ];

        const restaurantData = {
            almuzara: {
                label: "La Almuzara",
                badge: "PRINCIPAL",
                price: "$$",
                rating: "4.7",
                distance: "10 min",
                desc: "<strong>Restaurante Principal - Calle Marqu√©s del Arco, 3</strong><br><strong>Lo mejor:</strong> Aut√©ntica cocina tradicional castellana en pleno centro hist√≥rico de Segovia. Especialistas en asados y platos de cuchara t√≠picos segovianos. Ambiente acogedor y familiar, perfecto para grupos. Excelente relaci√≥n calidad-precio con productos de la tierra.",
                shortDesc: "Cocina tradicional castellana ‚Ä¢ Platos de cuchara ‚Ä¢ Men√∫s especiales",
                scores: [5, 4, 5, 5], // Calidad, Ambiente, Precio, Ubicaci√≥n
                mapsUrl: "https://www.google.com/maps/search/?api=1&query=La+Almuzara+Calle+Marques+del+Arco+3+Segovia",
                menuUrl: "https://www.google.com/search?q=La+Almuzara+Segovia+menu"
            },
            josemaria: {
                label: "Jos√© Mar√≠a",
                badge: "",
                price: "$$$",
                rating: "4.8",
                distance: "5 min",
                desc: "<strong>Famoso por su cochinillo</strong><br>Restaurante ic√≥nico de Segovia, conocido en toda Espa√±a por su excepcional cochinillo asado. Alta demanda, ambiente animado y servicio profesional. Ideal para una experiencia gastron√≥mica aut√©ntica en el coraz√≥n de la ciudad.",
                shortDesc: "Famoso cochinillo ‚Ä¢ Alta demanda ‚Ä¢ Ambiente animado",
                scores: [5, 5, 3, 5],
                mapsUrl: "https://www.google.com/maps/search/?api=1&query=Jose+Maria+Segovia",
                menuUrl: "https://www.google.com/search?q=Jose+Maria+Segovia+menu"
            },
            casares: {
                label: "Restaurante Casares",
                badge: "",
                price: "$$",
                rating: "4.5",
                distance: "3 min",
                desc: "<strong>Vistas al Acueducto</strong><br>Ubicaci√≥n privilegiada junto al Acueducto con men√∫ vegetariano expl√≠cito. Ideal para grupos mixtos donde se quiere asegurar opciones para todos. Buena relaci√≥n calidad-precio con vistas espectaculares.",
                shortDesc: "Junto al Acueducto ‚Ä¢ Men√∫ Vegetariano espec√≠fico",
                scores: [4, 5, 4, 5],
                mapsUrl: "https://www.google.com/maps/search/?api=1&query=Restaurante+Casares+Segovia",
                menuUrl: "https://www.restaurantecasares.com/carta/"
            },
            bernardino: {
                label: "El Bernardino",
                badge: "",
                price: "$$",
                rating: "4.5",
                distance: "8 min",
                desc: "<strong>Terraza con vistas</strong><br>Ambiente m√°s relajado que otros restaurantes tradicionales, con una terraza excelente (aunque con lluvia no aplica). Cocina castellana de calidad a buen precio. Perfecto para quien busca algo m√°s tranquilo.",
                shortDesc: "Excelente terraza ‚Ä¢ Ambiente relajado ‚Ä¢ Buena relaci√≥n calidad-precio",
                scores: [4, 5, 4, 4],
                mapsUrl: "https://www.google.com/maps/search/?api=1&query=El+Bernardino+Segovia",
                menuUrl: "https://www.google.com/search?q=El+Bernardino+Segovia+menu"
            }
        };

        const checklistItems = [
            "Reservar Restaurante (Prioridad M√°xima)",
            "Comprar entradas Alc√°zar (Turno 11:30/12:00)",
            "Enviar ubicaci√≥n Parking al grupo",
            "Chequear paraguas y calzado c√≥modo"
        ];

        // --- Logic: Timeline ---
        function initTimeline() {
            const nav = document.getElementById('timeline-nav');
            const content = document.getElementById('timeline-content');
            
            // Create Buttons
            timelineData.forEach((item, index) => {
                const btn = document.createElement('button');
                btn.className = `flex items-center gap-2 px-5 py-2.5 rounded-full transition-all shrink-0 ${index === 0 ? 'active-timeline-btn' : 'inactive-timeline-btn'} border-2`;
                btn.innerHTML = `
                    <span class="font-bold text-sm tracking-wide">${item.time}</span>
                    <span class="material-symbols-outlined text-[18px]">${item.icon}</span>
                `;
                btn.onclick = () => loadTimelineItem(index, btn);
                nav.appendChild(btn);
            });

            // Load initial
            loadTimelineItem(0, nav.children[0]);
        }

        function loadTimelineItem(index, activeBtn) {
            const data = timelineData[index];
            const contentDiv = document.getElementById('timeline-content');
            
            // Update buttons style
            const buttons = document.getElementById('timeline-nav').children;
            for(let btn of buttons) {
                btn.classList.remove('active-timeline-btn');
                btn.classList.add('inactive-timeline-btn');
            }
            activeBtn.classList.remove('inactive-timeline-btn');
            activeBtn.classList.add('active-timeline-btn');

            // Update Content with fade effect
            contentDiv.style.opacity = 0;
            setTimeout(() => {
                contentDiv.innerHTML = `
                    <div class="absolute left-0 top-0 bottom-0 w-1.5 bg-primary rounded-l-xl z-10 h-full"></div>
                    <div class="bg-stone-50/50 dark:bg-stone-900/50 backdrop-blur-sm rounded-xl border border-stone-100 dark:border-stone-800 p-8 pl-10 shadow-sm">
                        <div class="flex flex-col md:flex-row md:items-center gap-4 mb-6">
                            <div class="w-12 h-12 rounded-xl bg-primary flex items-center justify-center shadow-md shadow-primary/20 shrink-0">
                                <span class="material-symbols-outlined text-white text-2xl">${data.icon}</span>
                            </div>
                            <div>
                                <div class="flex items-baseline gap-3 mb-1">
                                    <h4 class="text-2xl font-bold font-serif text-stone-900 dark:text-white">${data.title}</h4>
                                    <span class="text-stone-400 font-light text-lg">| ${data.time}</span>
                                </div>
                                <p class="text-stone-500 dark:text-stone-400 font-medium">${data.desc}</p>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-stone-950 p-6 rounded-lg border border-stone-100 dark:border-stone-800 shadow-sm">
                            <p class="text-stone-700 dark:text-stone-300 text-lg leading-relaxed mb-4">
                                ${data.details}
                            </p>
                            <a href="${data.mapsUrl}" target="_blank" rel="noopener noreferrer" 
                               class="inline-flex items-center px-4 py-2 bg-primary hover:bg-primary/90 text-white text-sm font-semibold rounded-lg transition-colors shadow-sm mt-4">
                                <span class="material-symbols-outlined text-lg mr-2">location_on</span>
                                Ver en Mapa
                            </a>
                        </div>
                    </div>
                `;
                contentDiv.style.opacity = 1;
                contentDiv.style.transition = 'opacity 0.3s ease';
            }, 200);
        }

        // --- Logic: Restaurants ---
        let currentRestaurant = 'almuzara';
        
        function initRestaurants() {
            const container = document.getElementById('restaurant-list');
            
            Object.keys(restaurantData).forEach((key, index) => {
                const rest = restaurantData[key];
                const isFirst = index === 0;
                
                const card = document.createElement('div');
                card.className = `p-6 rounded-xl bg-white dark:bg-stone-900 shadow-sm cursor-pointer transition-all ${isFirst ? 'restaurant-card-selected' : 'restaurant-card-unselected'}`;
                card.id = `rest-card-${key}`;
                card.onclick = () => updateChart(key);
                
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <div class="flex items-center gap-2">
                            <h4 class="text-xl font-bold font-serif text-stone-900 dark:text-white">${rest.label}</h4>
                            ${rest.badge ? `<span class="bg-primary/10 text-primary px-2 py-0.5 rounded text-xs font-bold">${rest.badge}</span>` : ''}
                        </div>
                        <span class="bg-stone-100 dark:bg-stone-800 text-stone-600 dark:text-stone-300 px-2 py-0.5 rounded text-xs font-bold">${rest.price}</span>
                    </div>
                    <p class="text-sm text-stone-500 dark:text-stone-400 mb-3">${rest.shortDesc}</p>
                    <div class="flex gap-4 text-xs font-medium text-stone-400">
                        <span class="flex items-center gap-1">
                            <span class="material-symbols-outlined text-[14px]">star</span> ${rest.rating}
                        </span>
                        <span class="flex items-center gap-1">
                            <span class="material-symbols-outlined text-[14px]">directions_walk</span> ${rest.distance}
                        </span>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        function updateChart(key) {
            currentRestaurant = key;
            const selection = restaurantData[key];
            const detailDiv = document.getElementById('rest-detail');
            
            // Update card styles
            Object.keys(restaurantData).forEach(k => {
                const card = document.getElementById(`rest-card-${k}`);
                if (k === key) {
                    card.classList.remove('restaurant-card-unselected');
                    card.classList.add('restaurant-card-selected');
                } else {
                    card.classList.remove('restaurant-card-selected');
                    card.classList.add('restaurant-card-unselected');
                }
            });
            
            // Update Chart Data
            myRadarChart.data.datasets[0].data = selection.scores;
            myRadarChart.data.datasets[0].label = selection.label;
            myRadarChart.update();

            // Update Text with Links
            detailDiv.innerHTML = `
                <h5 class="text-sm font-bold text-stone-900 dark:text-white uppercase tracking-wider mb-2">Seleccionado: ${selection.label}</h5>
                <p class="text-xs text-stone-500 dark:text-stone-400 max-w-xs mx-auto mb-4">${selection.desc}</p>
                <div class="flex flex-wrap gap-2 justify-center">
                    <a href="${selection.mapsUrl}" target="_blank" rel="noopener noreferrer" 
                       class="inline-flex items-center px-3 py-1.5 bg-primary hover:bg-primary/90 text-white text-xs font-semibold rounded-lg transition-colors shadow-sm">
                        <span class="material-symbols-outlined text-sm mr-1.5">location_on</span>
                        Ver Mapa
                    </a>
                    <a href="${selection.menuUrl}" target="_blank" rel="noopener noreferrer" 
                       class="inline-flex items-center px-3 py-1.5 bg-stone-700 hover:bg-stone-800 text-white text-xs font-semibold rounded-lg transition-colors shadow-sm">
                        <span class="material-symbols-outlined text-sm mr-1.5">restaurant_menu</span>
                        Ver Men√∫
                    </a>
                </div>
            `;
        }

        // --- Logic: Chart.js ---
        let myRadarChart;

        function initChart() {
            const ctx = document.getElementById('restaurantChart').getContext('2d');
            
            const data = {
                labels: ['Calidad', 'Ambiente', 'Precio', 'Ubicaci√≥n'],
                datasets: [{
                    label: 'Puntuaci√≥n',
                    data: restaurantData.almuzara.scores,
                    fill: true,
                    backgroundColor: 'rgba(23, 161, 78, 0.2)',
                    borderColor: '#17a14e',
                    pointBackgroundColor: '#17a14e',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: '#17a14e'
                }]
            };

            const config = {
                type: 'radar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    elements: {
                        line: { borderWidth: 3 }
                    },
                    scales: {
                        r: {
                            angleLines: { color: '#e5e7eb' },
                            grid: { color: '#e5e7eb' },
                            pointLabels: {
                                font: { size: 11, family: "'Inter', sans-serif", weight: '600' },
                                color: '#6b7280'
                            },
                            suggestedMin: 0,
                            suggestedMax: 5,
                            ticks: { 
                                display: true,
                                stepSize: 1,
                                font: { size: 9 },
                                color: '#9ca3af'
                            }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: '#1f2937',
                            titleFont: { family: "'Inter', sans-serif", size: 13, weight: 'bold' },
                            bodyFont: { family: "'Inter', sans-serif", size: 12 },
                            padding: 12,
                            cornerRadius: 8
                        }
                    }
                }
            };

            myRadarChart = new Chart(ctx, config);
        }

        // --- Logic: Checklist ---
        let customTasks = [];
        
        // Load custom tasks from localStorage
        function loadCustomTasks() {
            const saved = localStorage.getItem('segoviaCustomTasks');
            if (saved) {
                try {
                    customTasks = JSON.parse(saved);
                } catch (e) {
                    customTasks = [];
                }
            }
        }
        
        // Save custom tasks to localStorage
        function saveCustomTasks() {
            localStorage.setItem('segoviaCustomTasks', JSON.stringify(customTasks));
        }
        
        // Create a single task element
        function createTaskElement(item, index, isCustom = false) {
            const label = document.createElement('label');
            label.className = "group flex items-center gap-4 cursor-pointer p-3 rounded-lg hover:bg-white dark:hover:bg-stone-900 transition-colors";
            label.innerHTML = `
                <input type="checkbox" id="task-${isCustom ? 'custom-' : ''}${index}" class="peer sr-only">
                <div class="w-6 h-6 rounded-full border-2 border-stone-300 dark:border-stone-600 peer-checked:bg-primary peer-checked:border-primary transition-all relative flex items-center justify-center">
                    <span class="material-symbols-outlined text-white text-[16px] opacity-0 peer-checked:opacity-100">check</span>
                </div>
                <span class="text-stone-600 dark:text-stone-300 peer-checked:text-stone-400 peer-checked:line-through transition-colors flex-grow">${item}</span>
                ${isCustom ? '<button class="delete-task-btn opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-red-100 dark:hover:bg-red-900/30 rounded" data-index="' + index + '"><span class="material-symbols-outlined text-red-600 dark:text-red-400 text-[18px]">delete</span></button>' : ''}
            `;
            
            const checkbox = label.querySelector('input');
            const textSpan = label.querySelector('span:nth-child(3)');
            const iconDiv = label.querySelector('div');
            
            // Checkbox toggle
            label.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON' || e.target.closest('button')) {
                    return; // Don't toggle checkbox when clicking delete button
                }
                if (e.target.tagName !== 'INPUT') {
                    checkbox.checked = !checkbox.checked;
                }
                
                if(checkbox.checked) {
                    textSpan.classList.add('line-through', 'text-stone-400');
                    iconDiv.classList.add('bg-primary', 'border-primary');
                    iconDiv.querySelector('.material-symbols-outlined').classList.remove('opacity-0');
                    iconDiv.querySelector('.material-symbols-outlined').classList.add('opacity-100');
                } else {
                    textSpan.classList.remove('line-through', 'text-stone-400');
                    iconDiv.classList.remove('bg-primary', 'border-primary');
                    iconDiv.querySelector('.material-symbols-outlined').classList.remove('opacity-100');
                    iconDiv.querySelector('.material-symbols-outlined').classList.add('opacity-0');
                }
            });
            
            // Delete button for custom tasks
            if (isCustom) {
                const deleteBtn = label.querySelector('.delete-task-btn');
                deleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    deleteCustomTask(index);
                });
            }
            
            return label;
        }
        
        // Render all tasks
        function renderChecklist() {
            const container = document.getElementById('checklist-container');
            container.innerHTML = '';
            
            // Add default tasks
            checklistItems.forEach((item, i) => {
                container.appendChild(createTaskElement(item, i, false));
            });
            
            // Add custom tasks
            customTasks.forEach((item, i) => {
                container.appendChild(createTaskElement(item, i, true));
            });
        }
        
        // Add new custom task
        function addCustomTask() {
            const input = document.getElementById('new-task-input');
            const taskText = input.value.trim();
            
            if (taskText) {
                customTasks.push(taskText);
                saveCustomTasks();
                renderChecklist();
                input.value = '';
                input.focus();
            }
        }
        
        // Delete custom task
        function deleteCustomTask(index) {
            customTasks.splice(index, 1);
            saveCustomTasks();
            renderChecklist();
        }
        
        function initChecklist() {
            loadCustomTasks();
            renderChecklist();
            
            // Add event listeners
            const addBtn = document.getElementById('add-task-btn');
            const input = document.getElementById('new-task-input');
            
            addBtn.addEventListener('click', addCustomTask);
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    addCustomTask();
                }
            });
        }

        // --- Init ---
        document.addEventListener('DOMContentLoaded', () => {
            initTimeline();
            initRestaurants();
            initChart();
            initChecklist();
            
            // Initialize first restaurant view
            updateChart('almuzara');
        });

    </script>
</body>
</html>
